<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fonologinis suvokimas - Rask tr≈´kstamƒÖ skiemenƒØ</title>
    <link href="https://fonts.googleapis.com/css2?family=OpenDyslexic&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'OpenDyslexic', Arial, sans-serif;
            font-size: 18px;
            line-height: 1.8;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        /* Vir≈°utinƒó juosta */
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
        }

        .grizti-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #89b5f5;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 16px;
            font-family: 'OpenDyslexic', Arial, sans-serif;
            cursor: pointer;
            transition: all 0.3s;
        }

        .grizti-btn:hover {
            background: #6a9de8;
            transform: translateX(-3px);
        }

        .mokinys-info {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px 20px;
            background: white;
            border: 2px solid #3498db;
            border-radius: 10px;
        }

        .mokinys-vardas {
            font-weight: bold;
            color: #3498db;
            font-size: 20px;
        }

        .keisti-btn {
            background: #89b5f5;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 14px;
            font-family: 'OpenDyslexic', Arial, sans-serif;
            cursor: pointer;
            transition: all 0.3s;
        }

        .keisti-btn:hover {
            background: #6a9de8;
        }

        .header {
            background: linear-gradient(135deg, #89b5f5 0%, #a8c8f7 100%);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            text-align: center;
        }

        h1 {
            color: #1a1a1a;
            font-size: 32px;
            font-weight: bold;
            letter-spacing: 2px;
        }

        .instrukcijos {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .instrukcijos h2 {
            color: #2c3e50;
            font-size: 20px;
            margin-bottom: 15px;
        }

        .instrukcijos ol {
            margin-left: 25px;
            color: #34495e;
        }

        .instrukcijos li {
            margin: 10px 0;
            line-height: 1.8;
        }

        /* Progreso juosta */
        .progress-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50 0%, #8BC34A 100%);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Kortelƒós */
        .card {
            display: none;
        }

        .card.active {
            display: block;
        }

        .card-header {
            text-align: center;
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .instruction-text {
            text-align: center;
            font-size: 18px;
            color: #1A4D7A;
            margin-bottom: 30px;
            background-color: #E8F4F8;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #4A90E2;
        }

        /* ≈Ωod≈æio konteineris */
        .word-container {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            background-color: #ffffff;
            border-radius: 15px;
            padding: 40px 20px;
            margin: 30px 0;
            min-height: 120px;
            border: 3px solid #4A90E2;
            box-shadow: 0 4px 15px rgba(26, 77, 122, 0.15);
        }

        .word-container span.letter {
            font-size: 48px;
            font-weight: bold;
            color: #0D3B66;
            transition: transform 0.2s ease-in-out;
        }

        /* Paspaud≈æiama sritis tarp raid≈æi≈≥ */
        .word-container .divider {
            width: 24px;
            height: 60px;
            cursor: pointer;
            position: relative;
            border-radius: 6px;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 2px;
        }

        .word-container .divider:hover {
            background-color: #E8F4F8;
        }

        .word-container .divider.selected {
            background-color: #4A90E2;
        }

        .word-container .divider.selected::after {
            content: '|';
            color: white;
            font-weight: bold;
            font-size: 3rem;
            line-height: 1;
        }

        /* ƒÆterptas skiemuo */
        .inserted-syllable {
            font-size: 48px;
            font-weight: bold;
            color: #4A90E2;
            padding: 0 5px;
            background-color: #E8F4F8;
            border-radius: 8px;
            margin: 0 3px;
        }

        .inserted-syllable.correct {
            color: #27ae60;
            background-color: #d4edda;
        }

        .inserted-syllable.incorrect {
            color: #e74c3c;
            background-color: #f8d7da;
        }

        /* Dropdown su pasirinkimais */
        .syllable-dropdown {
            display: none;
            position: absolute;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            border: 3px solid #4A90E2;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 100;
            min-width: 150px;
        }

        .syllable-dropdown.active {
            display: block;
        }

        .syllable-option {
            padding: 12px 20px;
            margin: 5px 0;
            background: #ecf0f1;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .syllable-option:hover {
            background: #d5dbdb;
            transform: translateY(-2px);
        }

        /* Mygtukai */
        .controls {
            text-align: center;
            margin: 25px 0;
        }

        .btn {
            background: linear-gradient(135deg, #4A90E2, #0D3B66);
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 10px;
            font-size: 18px;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
            font-family: 'OpenDyslexic', Arial, sans-serif;
            font-weight: bold;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 144, 226, 0.4);
        }

        .btn.hidden {
            display: none;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-success {
            background: linear-gradient(135deg, #4ECDC4, #27ae60);
        }

        /* Feedback */
        .feedback {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            min-height: 60px;
        }

        .feedback .text-green {
            color: #155724;
            background-color: #d4edda;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid #c3e6cb;
            display: inline-block;
        }

        .feedback .text-red {
            color: #721c24;
            background-color: #f8d7da;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid #f5c6cb;
            display: inline-block;
        }

        .feedback .correct-answer {
            color: #1A4D7A;
            margin-top: 10px;
            display: block;
            font-size: 20px;
        }

        /* Rezultat≈≥ kortelƒó */
        .results-card {
            background-color: #ffffff;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 4px 15px rgba(26, 77, 122, 0.15);
            border: 3px solid #4ECDC4;
            text-align: center;
            margin-top: 30px;
        }

        .results-card.hidden {
            display: none;
        }

        .results-card h2 {
            font-size: 32px;
            color: #0D3B66;
            margin-bottom: 20px;
        }

        .final-score {
            font-size: 48px;
            color: #4A90E2;
            font-weight: bold;
            margin: 20px 0;
        }

        .accuracy {
            font-size: 24px;
            color: #1A4D7A;
            margin-bottom: 30px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            h1 {
                font-size: 24px;
            }

            .top-bar {
                flex-direction: column;
                gap: 15px;
            }

            .word-container span.letter {
                font-size: 36px;
            }

            .inserted-syllable {
                font-size: 36px;
            }

            .btn {
                padding: 12px 25px;
                font-size: 16px;
                margin: 5px;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <!-- Vir≈°utinƒó juosta -->
    <div class="top-bar">
        <button class="grizti-btn" onclick="griztiIPradzia()">
            ‚Üê GrƒØ≈æti ƒØ prad≈æiƒÖ
        </button>
        <div class="mokinys-info">
            <span>Mokinys:</span>
            <span class="mokinys-vardas" id="rodomas-vardas"></span>
            <button class="keisti-btn" onclick="keistiVarda()">Keisti vardƒÖ</button>
        </div>
    </div>

    <div class="header">
        <h1>U≈ΩDUOTIS | Fonologinis suvokimas</h1>
    </div>

    <div class="instrukcijos">
        <h2>üìã Kaip atlikti u≈æduotƒØ:</h2>
        <ol>
            <li><strong>Perskaityk</strong> ≈æodƒØ ir pagalvok, kurio skiemens tr≈´ksta.</li>
            <li><strong>Paspausk tarp raid≈æi≈≥</strong>, kur manai, kad tr≈´ksta skiemens.</li>
            <li><strong>Pasirink</strong> teisingƒÖ skiemenƒØ i≈° sƒÖra≈°o.</li>
            <li><strong>Spausk "Pasitikrinti"</strong> ir perskaityk garsiai gautƒÖ ≈æodƒØ.</li>
        </ol>
    </div>

    <!-- Progreso juosta -->
    <div class="progress-container">
        <h3>üìä J≈´s≈≥ pa≈æanga</h3>
        <div class="progress-bar">
            <div id="progress" class="progress-fill"></div>
        </div>
        <p id="progress-text">Atlikta: 0 / 8 u≈æduoƒçi≈≥</p>
    </div>

    <!-- Kortelƒós -->
    <div id="cards-container"></div>

    <!-- Rezultat≈≥ kortelƒó -->
    <div id="results-card" class="results-card hidden">
        <h2>üéâ U≈æduotis baigta!</h2>
        <div id="final-score" class="final-score"></div>
        <div id="accuracy" class="accuracy"></div>
        <button class="btn btn-success" onclick="location.reload()">üîÑ Pradƒóti i≈° naujo</button>
    </div>

</div>

<script src="https://kalbosupe-dotcom.github.io/Mokyklai/js/results.js"></script>
<script>
    // --- U≈æduoƒçi≈≥ duomenys ---
    const words = [
        { 
            word: 'treƒçianis', 
            correctSyllable: 'die', 
            position: 6, // po "treƒçia"
            options: ['die', 'tie', 'dƒó'],
            fullWord: 'treƒçiadienis',
            syllables: 'tre-ƒçia-die-nis'
        },
        { 
            word: 'lodija', 
            correctSyllable: 'me', 
            position: 0, // prad≈æioje
            options: ['me', 'mƒó', 'mie'],
            fullWord: 'melodija',
            syllables: 'me-lo-di-ja'
        },
        { 
            word: 'kenƒó', 
            correctSyllable: 'lio', 
            position: 2, // po "ke"
            options: ['io', 'lio', 'lo'],
            fullWord: 'kelionƒó',
            syllables: 'ke-lio-nƒó'
        },
        { 
            word: 'kunugaris', 
            correctSyllable: 'pra', 
            position: 2, // po "ku"
            options: ['pra', 'bra', 'pa'],
            fullWord: 'kupranugaris',
            syllables: 'kup-ra-nu-ga-ris'
        },
        { 
            word: 'pusserƒó', 
            correctSyllable: 'se', 
            position: 5, // po "pusse"
            options: ['se', 'e', 'sƒó'],
            fullWord: 'pusseserƒó',
            syllables: 'pus-se-se-rƒó'
        },
        { 
            word: 'delis', 
            correctSyllable: 'puo', 
            position: 0, // prad≈æioje
            options: ['po', 'pou', 'puo'],
            fullWord: 'puodelis',
            syllables: 'puo-de-lis'
        },
        { 
            word: 'lesyklƒó', 
            correctSyllable: 'lƒó', 
            position: 7, // po "lesyklƒó"
            options: ['le', 'lƒó', 'lie'],
            fullWord: 'lesyklƒólƒó',
            syllables: 'le-syk-lƒó-lƒó'
        },
        { 
            word: 'vardis', 
            correctSyllable: 'b≈´d', 
            position: 0, // prad≈æioje
            options: ['b≈´t', 'b≈´d', 'bud'],
            fullWord: 'b≈´dvardis',
            syllables: 'b≈´d-var-dis'
        }
    ];

    // --- B≈´senos kintamieji ---
    let currentWordIndex = 0;
    let selectedPosition = null;
    let selectedSyllable = null;
    let isChecked = false;
    let correctAnswers = 0;
    let mokinioVardas = '';

    // --- DOM elementai ---
    const cardsContainer = document.getElementById('cards-container');
    const progressFill = document.getElementById('progress');
    const progressText = document.getElementById('progress-text');
    const resultsCard = document.getElementById('results-card');
    const finalScoreEl = document.getElementById('final-score');
    const accuracyEl = document.getElementById('accuracy');

    // --- Vard≈≥ valdymas ---
    function showNamePrompt() {
        const studentName = localStorage.getItem('studentName');
        
        if (!studentName) {
            const name = prompt('ƒÆveskite savo vardƒÖ:');
            if (name && name.trim() !== '') {
                localStorage.setItem('studentName', name.trim());
                return name.trim();
            } else {
                alert('Pra≈°ome ƒØvesti vardƒÖ, kad galƒótumƒóte pradƒóti u≈æduotƒØ.');
                return showNamePrompt();
            }
        }
        return studentName;
    }

    function changeName() {
        localStorage.removeItem('studentName');
        const newName = showNamePrompt();
        document.getElementById('rodomas-vardas').textContent = newName;
        mokinioVardas = newName;
    }

    function sendResultToSheet(taskName, score) {
        const studentName = localStorage.getItem('studentName') || 'Ne≈æinomas';
        const timestamp = new Date().toLocaleString('lt-LT');
    
        const data = {
            name: studentName,
            task: taskName,
            score: score,
            timestamp: timestamp
        };
    
        console.log('Siunƒçiamas rezultatas:', data);
    
        fetch('https://script.google.com/macros/s/AKfycbzhXP3hJ6NBLOld6Gbg-tlN-Tk8BPoxx32tx9j-iKCJChVyeOpZiDyGu9g2cm6Vl0uf/exec', {
            method: 'POST',
            mode: 'no-cors',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        })
        .then(() => {
            console.log('Rezultatas sƒókmingai i≈°si≈≥stas ƒØ Google Sheets! ‚úÖ');
        })
        .catch(error => {
            console.error('Klaida siunƒçiant rezultatƒÖ:', error);
        });
    }

    // Inicializacija
    window.onload = function() {
        mokinioVardas = showNamePrompt();
        document.getElementById('rodomas-vardas').textContent = mokinioVardas;
        createAllCards();
        showCard(0);
    };

    // GrƒØ≈æti ƒØ prad≈æiƒÖ
    function griztiIPradzia() {
        window.history.back();
    }

    // Keisti vardƒÖ
    function keistiVarda() {
        changeName();
    }

    // --- Korteli≈≥ k≈´rimas ---
    function createAllCards() {
        words.forEach((wordData, index) => {
            const card = document.createElement('div');
            card.className = 'card';
            card.id = `card-${index}`;
            
            card.innerHTML = `
                <div class="card-header">U≈æduotis ${index + 1} / ${words.length}</div>
                <div class="instruction-text">Paspausk tarp raid≈æi≈≥, kur manai, kad tr≈´ksta skiemens, ir pasirink teisingƒÖ skiemenƒØ.</div>
                <div class="word-container" id="word-container-${index}"></div>
                <div class="controls">
                    <button class="btn" id="check-btn-${index}" onclick="checkAnswer(${index})" disabled>‚úÖ Pasitikrinti</button>
                    <button class="btn hidden" id="next-btn-${index}" onclick="goToNextWord(${index})">‚û°Ô∏è Kitas ≈æodis</button>
                </div>
                <div class="feedback" id="feedback-${index}"></div>
            `;
            
            cardsContainer.appendChild(card);
            displayWord(index);
        });
    }

    // --- ≈Ωod≈æio atvaizdavimas ---
    function displayWord(cardIndex) {
        const wordContainer = document.getElementById(`word-container-${cardIndex}`);
        const wordData = words[cardIndex];
        const word = wordData.word;
        
        wordContainer.innerHTML = '';
        
        // Pridƒóti divider prad≈æioje (jei skiemuo gali b≈´ti prad≈æioje)
        const startDivider = document.createElement('div');
        startDivider.className = 'divider';
        startDivider.dataset.position = '0';
        startDivider.dataset.cardIndex = cardIndex;
        startDivider.addEventListener('click', () => selectPosition(0, cardIndex, startDivider));
        wordContainer.appendChild(startDivider);
        
        // Pridƒóti raides ir dividers
        word.split('').forEach((letter, index) => {
            const letterSpan = document.createElement('span');
            letterSpan.className = 'letter';
            letterSpan.textContent = letter;
            wordContainer.appendChild(letterSpan);
            
            // Pridƒóti divider po kiekvienos raidƒós
            const divider = document.createElement('div');
            divider.className = 'divider';
            divider.dataset.position = (index + 1).toString();
            divider.dataset.cardIndex = cardIndex;
            divider.addEventListener('click', () => selectPosition(index + 1, cardIndex, divider));
            wordContainer.appendChild(divider);
        });
    }

    // --- Pozicijos pasirinkimas ---
    function selectPosition(position, cardIndex, dividerEl) {
        if (isChecked && cardIndex === currentWordIndex) return;
        if (cardIndex !== currentWordIndex) return;
        
        // Pa≈°alinti ankstesnƒØ pasirinkimƒÖ
        const allDividers = document.querySelectorAll(`#word-container-${cardIndex} .divider`);
        allDividers.forEach(div => {
            div.classList.remove('selected');
            const existingDropdown = div.querySelector('.syllable-dropdown');
            if (existingDropdown) {
                existingDropdown.remove();
            }
        });
        
        // Pa≈æymƒóti naujƒÖ pasirinkimƒÖ
        selectedPosition = position;
        dividerEl.classList.add('selected');
        
        // Sukurti dropdown su pasirinkimais
        const dropdown = document.createElement('div');
        dropdown.className = 'syllable-dropdown active';
        
        words[cardIndex].options.forEach(option => {
            const optionDiv = document.createElement('div');
            optionDiv.className = 'syllable-option';
            optionDiv.textContent = option;
            optionDiv.addEventListener('click', () => selectSyllable(option, cardIndex, dividerEl));
            dropdown.appendChild(optionDiv);
        });
        
        dividerEl.appendChild(dropdown);
    }

    // --- Skiemens pasirinkimas ---
    function selectSyllable(syllable, cardIndex, dividerEl) {
        selectedSyllable = syllable;
        
        // Pa≈°alinti dropdown
        const dropdown = dividerEl.querySelector('.syllable-dropdown');
        if (dropdown) {
            dropdown.remove();
        }
        
        // ƒÆterpti pasirinktƒÖ skiemenƒØ
        const insertedSpan = document.createElement('span');
        insertedSpan.className = 'inserted-syllable';
        insertedSpan.textContent = syllable;
        insertedSpan.id = `inserted-${cardIndex}`;
        
        // ƒÆterpti po divider
        dividerEl.classList.remove('selected');
        dividerEl.insertAdjacentElement('afterend', insertedSpan);
        
        // Aktyvuoti pasitikrinimo mygtukƒÖ
        document.getElementById(`check-btn-${cardIndex}`).disabled = false;
    }

    // --- Atsakymo tikrinimas ---
    function checkAnswer(cardIndex) {
        if (isChecked) return;
        isChecked = true;
        
        const wordData = words[cardIndex];
        const feedbackEl = document.getElementById(`feedback-${cardIndex}`);
        const checkBtn = document.getElementById(`check-btn-${cardIndex}`);
        const nextBtn = document.getElementById(`next-btn-${cardIndex}`);
        const insertedEl = document.getElementById(`inserted-${cardIndex}`);
        
        const isCorrect = selectedPosition === wordData.position && 
                         selectedSyllable === wordData.correctSyllable;
        
        if (isCorrect) {
            feedbackEl.innerHTML = `
                <span class="text-green">‚úÖ Puiku! Teisingai! üéâ</span>
                <span class="correct-answer">Teisingas ≈æodis: <b>${wordData.syllables}</b></span>
            `;
            if (insertedEl) {
                insertedEl.classList.add('correct');
            }
            correctAnswers++;
        } else {
            feedbackEl.innerHTML = `
                <span class="text-red">‚ùå Neteisingai. Pabandyk dar kartƒÖ!</span>
                <span class="correct-answer">üí° Teisingas ≈æodis: <b>${wordData.syllables}</b></span>
            `;
            if (insertedEl) {
                insertedEl.classList.add('incorrect');
            }
        }
        
        checkBtn.classList.add('hidden');
        nextBtn.classList.remove('hidden');
        
        if (cardIndex === words.length - 1) {
            nextBtn.textContent = 'üèÅ Baigti u≈æduotƒØ';
        }
        
        updateProgress();
    }

    // --- Kitas ≈æodis ---
    function goToNextWord(cardIndex) {
        if (cardIndex < words.length - 1) {
            currentWordIndex++;
            selectedPosition = null;
            selectedSyllable = null;
            isChecked = false;
            showCard(currentWordIndex);
        } else {
            showFinalResults();
        }
    }

    // --- Kortelƒós rodymas ---
    function showCard(index) {
        const allCards = document.querySelectorAll('.card');
        allCards.forEach(card => card.classList.remove('active'));
        
        const currentCard = document.getElementById(`card-${index}`);
        if (currentCard) {
            currentCard.classList.add('active');
        }
    }

    // --- Progreso atnaujinimas ---
    function updateProgress() {
        const completed = currentWordIndex + 1;
        const percentage = (completed / words.length) * 100;
        progressFill.style.width = percentage + '%';
        progressText.textContent = `Atlikta: ${completed} / ${words.length} u≈æduoƒçi≈≥`;
    }

    // --- Galutiniai rezultatai ---
    function showFinalResults() {
        cardsContainer.style.display = 'none';
        document.querySelector('.progress-container').style.display = 'none';
        resultsCard.classList.remove('hidden');
        
        const totalWords = words.length;
        const percentage = Math.round((correctAnswers / totalWords) * 100);
        
        finalScoreEl.textContent = `${correctAnswers} / ${totalWords} teising≈≥ atsakym≈≥`;
        accuracyEl.textContent = `Tikslumas: ${percentage}%`;
        
        sendResultToSheet('L0801 Fonologinis suvokimas | Rask tr≈´kstamƒÖ skiemenƒØ', percentage);
    }
</script>

</body>
</html>

