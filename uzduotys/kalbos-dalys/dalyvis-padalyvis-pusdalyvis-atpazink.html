<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veiksma≈æod≈æio Formos: Dalyvis, Pusdalyvis, Padalyvis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'OpenDyslexic', Arial, sans-serif;
            letter-spacing: 0.05em;
            background-color: #f3f4f6; /* gray-100 */
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .page-wrapper {
            width: 100%;
            max-width: 900px;
        }
        
        /* Vir≈°utinis info blokas */
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        .back-btn {
            display: inline-flex;
            align-items: center;
            padding: 12px 24px;
            background-color: #93c5fd;
            color: #1e3a8a;
            text-decoration: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            transition: background-color 0.3s;
            white-space: nowrap;
        }
        .back-btn:hover {
            background-color: #7CB3E9;
        }
        .student-info {
            background-color: #ffffff;
            padding: 10px 20px;
            border-radius: 10px;
            border: 2px solid #4A90E2;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-grow: 1;
        }
        .change-name-btn {
            background-color: #4A90E2;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        .change-name-btn:hover {
            background-color: #0D3B66;
        }

        /* Kortelƒós stiliai */
        .card {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 30px;
            border: 3px solid #60a5fa; /* blue-400 */
            min-height: 550px;
            display: none;
            flex-direction: column;
            justify-content: space-between;
        }
        .card.active {
            display: flex;
        }
        
        /* ATMINTINƒñS LENTELƒñ */
        .memo-table, .example-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.95rem;
        }
        .memo-table th, .memo-table td, .example-table th, .example-table td {
            border: 1px solid #e5e7eb;
            padding: 10px;
            text-align: left;
        }
        .memo-table th, .example-table th {
            background-color: #d1e5f8;
            color: #1f2937;
            font-weight: bold;
        }
        
        /* NAUJAS: Spalv≈≥ priskyrimas lentelƒóje */
        .memo-dalyvis, .btn-dalyvis {
            color: #15803d; /* Tamsiai ≈æalia */
            background-color: #dcfce7; /* Labai ≈°viesi ≈æalia */
        }
        .memo-pusdalyvis, .btn-pusdalyvis {
            color: #b45309; /* Tamsiai oran≈æinƒó */
            background-color: #fff7ed; /* Labai ≈°viesi oran≈æinƒó */
        }
        .memo-padalyvis, .btn-padalyvis {
            color: #1e40af; /* Tamsiai mƒólyna */
            background-color: #eff6ff; /* Labai ≈°viesi mƒólyna */
        }
        
        /* NAUJAS: Mygtuk≈≥ spalvos (pasirinkimo) */
        .option-btn {
            color: white;
            font-weight: 700;
            padding: 15px;
            border-radius: 8px;
            transition: all 0.2s;
            cursor: pointer;
            margin: 10px 0;
            font-size: 1.2rem;
            text-align: center;
        }
        .btn-dalyvis { background-color: #22c55e; } /* Ry≈°kiai ≈æalia */
        .btn-pusdalyvis { background-color: #f97316; } /* Ry≈°kiai oran≈æinƒó */
        .btn-padalyvis { background-color: #3b82f6; } /* Ry≈°kiai mƒólyna */
        
        .option-btn:hover:not(.disabled) {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .option-btn.correct { background-color: #10b981 !important; } /* ≈Ωalia (visada teisingai) */
        .option-btn.incorrect { background-color: #ef4444 !important; } /* Raudona (visada neteisingai) */
        
        /* Pakeista ≈æod≈æio fono spalva */
        .word-to-classify {
            font-size: 3rem;
            font-weight: bold;
            text-align: center;
            padding: 20px;
            background-color: #e3f2fd; /* ≈†viesiai ≈æydra */
            border-radius: 10px;
            border: 3px solid #7cb3e9;
            color: #1a4d7a;
            margin-bottom: 30px;
        }
        
        .disabled {
            pointer-events: none;
            opacity: 0.8;
        }
        
        /* Mobilusis dizainas */
        @media (max-width: 768px) {
             /* ... (palikta kaip buvo) ... */
        }
    </style>
</head>
<body>
    <div class="page-wrapper">
        
        <div class="header-container">
            <a href="/Mokyklai/" class="back-btn">‚Üê GrƒØ≈æti ƒØ prad≈æiƒÖ</a>
            
            <div class="student-info">
                Mokinys: <strong id="studentNameDisplay"></strong>
                <button class="change-name-btn" onclick="changeName()">Keisti vardƒÖ</button>
            </div>
        </div>

        <div id="card-memo" class="card active">
            <h1 class="question-title">üìö Atmintinƒó: Neasmenuojamosios Veiksma≈æod≈æio Formos</h1>

            <div style="margin-bottom: 20px;">
                <p style="font-size: 1.1rem; color: #1f2937;">
                    Neasmenuojamosios veiksma≈æod≈æio formos yra nekaitomos asmenimis, bet turi veiksma≈æod≈æio ir kitos kalbos dalies (da≈æniausiai b≈´dvard≈æio ar prieveiksmio) ypatybi≈≥.
                </p>
            </div>

            <table class="memo-table">
                <thead>
                    <tr>
                        <th>Forma</th>
                        <th>Klausimai</th>
                        <th>Priesagos</th>
                        <th>Pavyzdys</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><div class="memo-dalyvis"><strong>Dalyvis</strong> (B≈´dvard≈æio ypatybƒós)</div></td>
                        <td>Koks? Kokia?</td>
                        <td>-ant<strong>is</strong>, -us<strong>is</strong>, -im<strong>as</strong>, -t<strong>as</strong>, -s<strong>iƒÖs</strong></td>
                        <td><em>Bƒógant</em><strong>is</strong>, <em>pamatyt</em><strong>as</strong>, <em>dary</em><strong>sianƒçias</strong></td>
                    </tr>
                    <tr>
                        <td><div class="memo-pusdalyvis"><strong>Pusdalyvis</strong> (Prieveiksmio ypatybƒós)</div></td>
                        <td>KƒÖ veikdamas?</td>
                        <td>-d<strong>amas</strong>, -d<strong>ama</strong>, -dam<strong>i</strong>, -dam<strong>os</strong></td>
                        <td><em>Skait</em><strong>ydamas</strong>, <em>ra≈°y</em><strong>dama</strong>, <em>ne≈°</em><strong>dami</strong></td>
                    </tr>
                    <tr>
                        <td><div class="memo-padalyvis"><strong>Padalyvis</strong> (Prieveiksmio ypatybƒós)</div></td>
                        <td>Kaip? Kada? KƒÖ veikiant?</td>
                        <td>-ant, -int, -iant, -us, -ius, -<strong>us</strong>, -<strong>i≈´s</strong></td>
                        <td><em>Vaik≈°ƒçi</em><strong>ojant</strong>, <em>atmin</em><strong>us</strong>, <em>dirb</em><strong>iant</strong>, <em>va≈æiuoj</em><strong>ant</strong></td>
                    </tr>
                </tbody>
            </table>

            <div class="button-container mt-auto">
                <button onclick="showCard('card-task-1')" class="action-button bg-blue-600 hover:bg-blue-700 text-white">‚ñ∂Ô∏è Pradƒóti testƒÖ</button>
            </div>
        </div>

        <div id="task-cards-container"></div>

        <div id="card-results" class="card">
            <h2 class="question-title">üéâ Testo rezultatai</h2>
            <div class="result-container">
                <div class="result-details" id="result-details"></div>
                <div class="total-score" id="total-score"></div>
            </div>
            <div class="button-container">
                <button onclick="location.reload()" class="action-button btn-success">üîÑ Pradƒóti i≈° naujo</button>
            </div>
        </div>
    </div>

    <script>
        // --- KONFIGURACIJA ---
        const SHEET_URL = 'https://script.google.com/macros/s/AKfycbzhXP3hJ6NBLOld6Gbg-tlN-Tk8BPoxx32tx9j-iKCJChVyeOpZiDyGu9g2cm6Vl0uf/exec';
        const TASK_ID = 'L0311 Veiksmazod≈æio formos | 9 klausimai';
        
        // --- KLAUSIM≈≤ DUOMENYS (9 ≈æod≈æiai) ---
        // Visi ≈æod≈æiai, kurie baigiasi ƒØsi/ƒôs/ƒô, yra dalyviai, i≈°skyrus BƒñGANT (padalyvis)
        const QUESTIONS_DATA = [
            { word: "PAVARGƒòS", correct: "Dalyvis" },
            { word: "ATMINƒòS", correct: "Dalyvis" },
            { word: "PERSKAITYTAS", correct: "Dalyvis" },
            { word: "PA≈ΩVELGƒòS", correct: "Dalyvis" },
            { word: "NE≈†AMAS", correct: "Dalyvis" },
            { word: "PATEKƒòS", correct: "Dalyvis" },
            { word: "BƒñGANT", correct: "Padalyvis" },
            { word: "DARANTIS", correct: "Dalyvis" },
            { word: "VA≈ΩIUOSIƒÑS", correct: "Dalyvis" }
        ];
        
        const OPTIONS = [
            { name: "Dalyvis", css: "btn-dalyvis" },
            { name: "Pusdalyvis", css: "btn-pusdalyvis" },
            { name: "Padalyvis", css: "btn-padalyvis" }
        ];
        const totalQuestions = QUESTIONS_DATA.length; 

        // --- B≈™SENA ---
        let questionsShuffled = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let userAnswersLog = [];

        // --- VARD≈≤ VALDYMAS IR REZULTATAI ---

        function showNamePrompt() {
            const studentName = localStorage.getItem('studentName');
            if (!studentName) {
                const name = prompt('ƒÆvesk savo vardƒÖ:');
                if (name && name.trim() !== '') {
                    localStorage.setItem('studentName', name.trim());
                    return name.trim();
                } else {
                    alert('Pra≈°ome ƒØvesti vardƒÖ, kad galƒótumƒóte pradƒóti u≈æduotƒØ.');
                    return showNamePrompt();
                }
            }
            return studentName;
        }

        function changeName() {
            localStorage.removeItem('studentName');
            showNamePrompt();
            location.reload();
        }

        function sendResultToSheet(taskName, score) {
            const studentName = localStorage.getItem('studentName') || 'Ne≈æinomas';
            const timestamp = new Date().toLocaleString('lt-LT');
            const data = {
                name: studentName,
                task: taskName,
                score: score,
                timestamp: timestamp
            };
            fetch(SHEET_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            }).then(() => console.log('Rezultatas sƒókmingai i≈°si≈≥stas!'))
              .catch(error => console.error('Klaida siunƒçiant rezultatƒÖ:', error));
        }

        // --- PAGALBINƒñS FUNKCIJOS ---

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
        
        // --- KORTELI≈≤ GENERAVIMAS ---

        function generateTaskCards() {
            const container = document.getElementById('task-cards-container');
            questionsShuffled = shuffleArray(QUESTIONS_DATA); 
            
            questionsShuffled.forEach((question, index) => {
                const cardId = `card-task-${index + 1}`;
                const cardDiv = document.createElement('div');
                cardDiv.id = cardId;
                cardDiv.className = 'card';
                
                // Mai≈°ome pasirinkimus kiekvienam klausimui
                const optionsShuffled = shuffleArray([...OPTIONS]);

                const optionsHtml = optionsShuffled.map(opt => 
                    `<button class="option-btn ${opt.css}" data-answer="${opt.name}" onclick="checkAnswer(this, '${opt.name}', ${index + 1})">${opt.name}</button>`
                ).join('');
                
                // Nustatome CSS spalvas atminties lentelei
                const dalyvisCss = OPTIONS.find(o => o.name === 'Dalyvis').css.replace('btn-', 'memo-');
                const pusdalyvisCss = OPTIONS.find(o => o.name === 'Pusdalyvis').css.replace('btn-', 'memo-');
                const padalyvisCss = OPTIONS.find(o => o.name === 'Padalyvis').css.replace('btn-', 'memo-');

                cardDiv.innerHTML = `
                    <h2 class="question-title">Klausimas ${index + 1} i≈° ${totalQuestions}</h2>

                    <div class="word-to-classify">${question.word}</div>
                    
                    <div id="options-${index + 1}" class="flex flex-col space-y-4 mb-8">
                        ${optionsHtml}
                    </div>

                    <div id="feedback-${index + 1}" class="feedback"></div>

                    <div class="mt-auto pt-6 border-t">
                        <h3 class="font-bold text-lg text-blue-700 mb-2 border-b pb-1">üëÄ Atminties nuoroda: Pavyzd≈æiai</h3>
                        <table class="example-table">
                            <thead>
                                <tr>
                                    <th class="${dalyvisCss}">Dalyvis</th>
                                    <th class="${pusdalyvisCss}">Pusdalyvis</th>
                                    <th class="${padalyvisCss}">Padalyvis</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Dirbƒôs, Dirbamas, SkaitƒÖs</td>
                                    <td>Dirbdamas, Skaitydama</td>
                                    <td>Dirbant, Skaitant</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                `;
                container.appendChild(cardDiv);
            });
        }
        
        // --- TIKRINIMO LOGIKA ---

        function checkAnswer(button, selectedAnswer, questionNum) {
            const questionData = questionsShuffled[questionNum - 1];
            const correct = questionData.correct;
            const isCorrect = selectedAnswer === correct;
            
            const feedbackEl = document.getElementById(`feedback-${questionNum}`);
            const optionsContainer = document.getElementById(`options-${questionNum}`);
            
            // Pa≈æymime visus mygtukus
            optionsContainer.querySelectorAll('.option-btn').forEach(btn => {
                btn.classList.add('disabled');
                if (btn.dataset.answer === correct) {
                    btn.classList.add('correct');
                } else if (btn.dataset.answer === selectedAnswer) {
                    btn.classList.add('incorrect');
                }
            });

            if (isCorrect) {
                score++;
                feedbackEl.innerHTML = `<span class="text-green-600">‚úÖ Teisingai! Tai yra ${correct}.</span>`;
            } else {
                feedbackEl.innerHTML = `<span class="text-red-600">‚ùå Neteisingai. Teisingas atsakymas: ${correct}.</span>`;
            }

            // ƒÆra≈°ome atsakymƒÖ
            userAnswersLog.push({
                word: questionData.word,
                correct: correct,
                selected: selectedAnswer,
                isCorrect: isCorrect
            });

            // Pridƒóti Toliau mygtukƒÖ
            const nextBtn = document.createElement('button');
            nextBtn.className = 'action-button bg-blue-600 hover:bg-blue-700 text-white mt-4';
            
            if (questionNum < totalQuestions) {
                nextBtn.textContent = '‚û°Ô∏è Toliau';
                nextBtn.onclick = () => showCard(`card-task-${questionNum + 1}`);
            } else {
                nextBtn.textContent = 'üèÅ Rezultatai';
                nextBtn.onclick = showResults;
            }
            
            optionsContainer.appendChild(nextBtn);
        }

        // --- KORTELI≈≤ NAVIGACIJA ---

        function showCard(cardId) {
            document.querySelectorAll('.card').forEach(card => {
                card.classList.remove('active');
            });
            document.getElementById(cardId).classList.add('active');
            window.scrollTo(0, 0);
        }

        function showResults() {
            showCard('card-results');
            
            const totalScoreEl = document.getElementById('total-score');
            const resultDetailsEl = document.getElementById('result-details');
            
            const percentage = Math.round((score / totalQuestions) * 100);
            const scoreClass = percentage >= 70 ? 'score-good' : 'score-bad';
            
            totalScoreEl.innerHTML = `
                <div>Teisingai atsakyta: <strong>${score} i≈° ${totalQuestions}</strong></div>
                <div class="score-percentage ${scoreClass}">${percentage}%</div>
            `;
            
            // Detali suvestinƒó
            let detailsHTML = '';
            userAnswersLog.forEach((answer, index) => {
                const itemClass = answer.isCorrect ? 'correct-item' : 'incorrect-item';
                const icon = answer.isCorrect ? '‚úÖ' : '‚ùå';
                
                detailsHTML += `
                    <div class="p-3 rounded-md border ${itemClass}">
                        ${icon} <strong>${answer.word}</strong>: Pasirinkta: ${answer.selected}. Teisinga: ${answer.correct}.
                    </div>
                `;
            });
            resultDetailsEl.innerHTML = detailsHTML;
            
            // Siunƒçiame rezultatus
            sendResultToSheet(TASK_ID, percentage);
        }


        // --- INICIALIZACIJA ---

        window.onload = function() {
            const studentName = showNamePrompt();
            document.getElementById('studentNameDisplay').textContent = studentName;
            
            window.changeName = changeName;
            window.showCard = showCard;
            window.checkAnswer = checkAnswer;
            window.showResults = showResults;
            
            generateTaskCards();
            showCard('card-memo'); // Pradedame nuo atmintinƒós
        };
    </script>
</body>
</html>
