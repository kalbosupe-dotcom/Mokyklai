<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MejozÄ— ir MitozÄ—: SavybiÅ³ Klasifikavimas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* gray-100 */
        }
        .container-wrapper {
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
        }
        .card {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 30px;
            border: 3px solid #60a5fa; /* blue-400 */
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .question-box {
            background-color: #dbeafe; /* blue-100 */
            padding: 20px;
            border-radius: 8px;
            font-size: 1.4rem;
            font-weight: 600;
            text-align: center;
            color: #1e40af; /* blue-700 */
            margin-bottom: 30px;
        }
        .option-btn {
            background-color: #4f46e5; /* indigo-600 */
            color: white;
            font-weight: 700;
            padding: 15px;
            border-radius: 8px;
            transition: background-color 0.2s, transform 0.1s;
            cursor: pointer;
            margin: 10px 0;
            font-size: 1.2rem;
            text-align: center;
        }
        .option-btn:hover:not(.disabled) {
            background-color: #4338ca; /* indigo-700 */
            transform: translateY(-2px);
        }
        .option-btn.selected {
            border: 3px solid #10b981; /* emerald-500 */
        }
        .option-btn.correct {
            background-color: #10b981; /* emerald-500 */
        }
        .option-btn.incorrect {
            background-color: #ef4444; /* red-500 */
        }
        .disabled {
            pointer-events: none;
            opacity: 0.8;
        }
        .back-btn {
            display: inline-flex;
            align-items: center;
            background-color: #60a5fa; /* blue-400 */
            color: white;
            font-weight: 600;
            padding: 8px 16px;
            border-radius: 8px;
            transition: background-color 0.2s;
            text-decoration: none;
            margin-bottom: 20px;
        }
        .back-btn:hover {
            background-color: #3b82f6; /* blue-500 */
        }
    </style>
</head>
<body>

<div class="container-wrapper">

    <a href="/Mokyklai/" class="back-btn">â† GrÄ¯Å¾ti Ä¯ pradÅ¾iÄ…</a>

    <h1 class="text-3xl font-extrabold text-center text-gray-800 mb-6">
        MejozÄ— ar MitozÄ—?
    </h1>

    <div class="card" id="test-card">
        
        <div class="mb-6">
            <p class="text-lg font-semibold text-gray-500 mb-2 text-center" id="question-count">
                Klausimas 1 iÅ¡ 6
            </p>
            <div class="question-box" id="question-text">
                Klausiamosios savybÄ—s tekstas bus Äia.
            </div>
        </div>

        <div class="flex flex-col space-y-4" id="options-container">
            <button class="option-btn" data-type="Mejoze">MejozÄ—</button>
            <button class="option-btn" data-type="Mitoze">MitozÄ—</button>
        </div>

        <div class="mt-8 text-center">
            <div id="feedback-message" class="text-xl font-bold min-h-[30px] mb-4"></div>
            <button id="action-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-xl transition-colors">
                Patikrinti
            </button>
        </div>
    </div>

    <div class="card hidden mt-6" id="results-card">
        <h2 class="text-2xl font-bold text-center text-blue-700 mb-4">
            ğŸ‰ Rezultatai
        </h2>
        <p class="text-center text-xl font-semibold mb-6">
            Teisingai atsakyta: <span id="final-score" class="text-green-600"></span>
        </p>
        <div id="result-details" class="space-y-3 max-h-60 overflow-y-auto p-2 border rounded-md">
            </div>
        <button onclick="location.reload()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-lg text-lg mt-6">
            PradÄ—ti iÅ¡ naujo
        </button>
    </div>

</div>

<script>
    // 1. DUOMENYS
    const DATA = [
        { savybe: "Susidaro lytinÄ—s lÄ…stelÄ—s.", tipas: "Mejoze" },
        { savybe: "Susidaro kÅ«no lÄ…stelÄ—s.", tipas: "Mitoze" },
        { savybe: "IÅ¡ vienos motininÄ—s lÄ…stelÄ—s susidaro keturios dukterinÄ—s lÄ…stelÄ—s.", tipas: "Mejoze" },
        { savybe: "IÅ¡ vienos motininÄ—s lÄ…stelÄ—s susidaro dvi dukterinÄ—s lÄ…stelÄ—s.", tipas: "Mitoze" },
        { savybe: "Susidariusios lÄ…stelÄ—s yra skirtingos.", tipas: "Mejoze" },
        { savybe: "Susidariusios lÄ…stelÄ—s yra genetiÅ¡kai identiÅ¡kos.", tipas: "Mitoze" },
        { savybe: "SusidariusiÅ³ lÄ…steliÅ³ branduoliai turi skirtingÄ… paveldimÄ…jÄ… informacijÄ….", tipas: "Mejoze" },
        { savybe: "SusidariusiÅ³ lÄ…steliÅ³ branduoliai turi vienodÄ… paveldimÄ…jÄ… informacijÄ….", tipas: "Mitoze" },
        { savybe: "Branduolys dalijasi du kartus iÅ¡ eilÄ—s.", tipas: "Mejoze" },
        { savybe: "Branduolys dalijasi vienÄ… kartÄ….", tipas: "Mitoze" },
        { savybe: "Vyksta subrendusiame organizme.", tipas: "Mejoze" },
        { savybe: "Vyksta Ä¯vairaus amÅ¾iaus organizmuose.", tipas: "Mitoze" }
        // Pasirinkti 6 iÅ¡ 12 savybiÅ³, kad testas bÅ«tÅ³ kompaktiÅ¡kesnis
    ];

    // 2. ELEMENTAI
    const questionTextEl = document.getElementById('question-text');
    const questionCountEl = document.getElementById('question-count');
    const optionsContainer = document.getElementById('options-container');
    const actionBtn = document.getElementById('action-btn');
    const feedbackMessageEl = document.getElementById('feedback-message');
    const testCard = document.getElementById('test-card');
    const resultsCard = document.getElementById('results-card');
    const finalScoreEl = document.getElementById('final-score');
    const resultDetailsEl = document.getElementById('result-details');
    
    // 3. BÅªSENA
    let currentQuestions = []; // Klausimai, parinkti Å¡iam bandymui
    let currentQuestionIndex = 0;
    let score = 0;
    let isAnswerChecked = false;
    let selectedAnswer = null;

    // PAGALBINÄ–S FUNKCIJOS
    
    function shuffleArray(array) {
        // Funkcija sumaiÅ¡yti masyvo elementus atsitiktine tvarka
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function selectRandomQuestions(data, count) {
        // Atrinkti nurodytÄ… kiekÄ¯ atsitiktiniÅ³ klausimÅ³
        const shuffledData = shuffleArray([...data]);
        return shuffledData.slice(0, count);
    }

    // PAGRINDINÄ– LOGIKA

    function initializeTest() {
        // Pasirenkame 6 atsitiktinius klausimus iÅ¡ viso sÄ…raÅ¡o
        currentQuestions = selectRandomQuestions(DATA, 6); 
        currentQuestionIndex = 0;
        score = 0;
        showQuestion();
    }

    function showQuestion() {
        if (currentQuestionIndex >= currentQuestions.length) {
            showResults();
            return;
        }

        const question = currentQuestions[currentQuestionIndex];
        
        // Atnaujiname UI
        questionCountEl.textContent = `Klausimas ${currentQuestionIndex + 1} iÅ¡ ${currentQuestions.length}`;
        questionTextEl.textContent = question.savybe;
        feedbackMessageEl.textContent = '';
        actionBtn.textContent = 'Patikrinti';
        actionBtn.onclick = checkAnswer;

        isAnswerChecked = false;
        selectedAnswer = null;

        // Atstatome mygtukus
        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.classList.remove('correct', 'incorrect', 'disabled');
            btn.classList.add('bg-indigo-600', 'hover:bg-indigo-700');
            btn.onclick = handleOptionClick;
        });
    }

    function handleOptionClick(event) {
        if (isAnswerChecked) return;
        
        // PaÅ¡aliname pasirinkimÄ… nuo visÅ³ mygtukÅ³
        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.style.border = 'none';
        });

        // PaÅ¾ymime pasirinktÄ… mygtukÄ…
        event.target.style.border = '3px solid #60a5fa';
        selectedAnswer = event.target.dataset.type;
    }

    function checkAnswer() {
        if (!selectedAnswer) {
            feedbackMessageEl.innerHTML = '<span class="text-red-500">âŒ Pasirinkite atsakymÄ…!</span>';
            return;
        }

        isAnswerChecked = true;
        const correctType = currentQuestions[currentQuestionIndex].tipas;
        const isCorrect = selectedAnswer === correctType;

        // PaÅ¾ymime teisingÄ…/neteisingÄ… mygtukÄ…
        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.classList.add('disabled');
            btn.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');

            if (btn.dataset.type === correctType) {
                btn.classList.add('correct');
                btn.style.border = '3px solid #10b981';
            } else if (btn.dataset.type === selectedAnswer) {
                btn.classList.add('incorrect');
                btn.style.border = '3px solid #ef4444';
            }
        });

        if (isCorrect) {
            score++;
            feedbackMessageEl.innerHTML = '<span class="text-green-600">âœ… Teisingai!</span>';
        } else {
            feedbackMessageEl.innerHTML = '<span class="text-red-500">âŒ Neteisingai.</span>';
        }

        // ParuoÅ¡iame mygtukÄ… kitam klausimui
        actionBtn.textContent = (currentQuestionIndex < currentQuestions.length - 1) ? 'Toliau' : 'Rezultatai';
        actionBtn.onclick = nextQuestion;
    }

    function nextQuestion() {
        currentQuestionIndex++;
        selectedAnswer = null;
        showQuestion();
    }

    function showResults() {
        testCard.classList.add('hidden');
        resultsCard.classList.remove('hidden');

        finalScoreEl.textContent = `${score} iÅ¡ ${currentQuestions.length}`;
        const percentage = Math.round((score / currentQuestions.length) * 100);

        // Generuojame iÅ¡samiÄ… atsakymÅ³ suvestinÄ™
        let detailsHTML = '';
        currentQuestions.forEach((q, index) => {
            const status = userAnswers[index].isCorrect ? 'âœ… Teisingai' : 'âŒ Neteisingai';
            const statusClass = userAnswers[index].isCorrect ? 'text-green-700' : 'text-red-700';

            detailsHTML += `
                <div class="p-3 rounded-md border ${userAnswers[index].isCorrect ? 'border-green-300 bg-green-50' : 'border-red-300 bg-red-50'}">
                    <p class="font-bold text-gray-800">${index + 1}. ${q.savybe}</p>
                    <p class="${statusClass} font-semibold mt-1">
                        Atsakymas: ${q.tipas} (${status})
                    </p>
                </div>
            `;
        });

        resultDetailsEl.innerHTML = detailsHTML;
        
        // TODO: Jei naudojate Google Sheets, Äia iÅ¡siÅ³stumÄ—te galutinÄ¯ rezultatÄ….
        // sendResultToSheet('B0004 MejozÄ— vs MitozÄ— | Klasifikacija', percentage);
        
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Pradinis paleidimas
    initializeTest();

</script>
</body>
</html>
