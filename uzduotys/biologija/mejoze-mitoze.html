<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MejozÄ— ir MitozÄ—: SavybiÅ³ Klasifikavimas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* gray-100 */
        }
        /* Didesnis plotis ir Å¡riftai */
        .container-wrapper {
            max-width: 960px;           /* buvo 650px */
            margin: 20px auto;
            padding: 24px;
        }
        .card {
            background-color: #ffffff;
            border-radius: 16px;        /* Å¡iek tiek labiau â€kortelÄ—â€œ */
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.12);
            padding: 32px;
            border: 3px solid #60a5fa;  /* blue-400 */
            min-height: 420px;
            display: none;
            flex-direction: column;
            justify-content: space-between;
        }
        .card.active {
            display: flex;
        }
        .question-box {
            background-color: #dbeafe;
            padding: 24px;
            border-radius: 10px;
            font-size: 1.6rem;          /* buvo 1.4rem */
            font-weight: 600;
            text-align: center;
            color: #1e40af;
            min-height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 32px;
        }

        /* Mygtukai: oranÅ¾inis ir Å¾alias, vienoje juostoje */
        .options-row {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }
        .option-btn {
            color: white;
            font-weight: 700;
            padding: 14px 32px;
            border-radius: 9999px;      /* â€tabletÄ—sâ€œ formos */
            transition: background-color 0.2s, transform 0.1s, border 0.2s;
            cursor: pointer;
            font-size: 1.4rem;
            text-align: center;
            min-width: 150px;
        }
        .btn-mejoze {
            background-color: #8CC4EC;  /* mÄ—lyna */
        }
        .btn-mejoze:hover:not(.disabled) {
            background-color: #ea580c;
            transform: translateY(-2px);
        }
        .btn-mitoze {
            background-color: #A3DDBB;  /* Å¾alia */
        }
        .btn-mitoze:hover:not(.disabled) {
            background-color: #16a34a;
            transform: translateY(-2px);
        }
        .option-btn.correct {
            background-color: #16a34a;  /* teisingas â€“ Å¾alia */
        }
        .option-btn.incorrect {
            background-color: #ef4444;  /* neteisingas â€“ raudona */
        }
        .option-btn.selected-border {
            border: 3px solid #facc15;  /* geltonas rÄ—melis */
        }
        .disabled {
            pointer-events: none;
            opacity: 0.85;
        }

        .header-row {
            display: flex;
            gap: 16px;
            margin-bottom: 18px;
            align-items: center;
            flex-wrap: wrap;
        }
        .back-btn {
            display: inline-flex;
            align-items: center;
            background-color: #93c5fd;
            color: #1e3a8a;
            font-weight: 600;
            padding: 12px 24px;
            border-radius: 8px;
            transition: background-color 0.2s;
            text-decoration: none;
            white-space: nowrap;
        }
        .back-btn:hover {
            background-color: #60a5fa;
        }
        .student-info {
            background-color: #ffffff;
            padding: 10px 20px;
            border-radius: 8px;
            flex-grow: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #d1d5db;
            font-size: 1.05rem;         /* truputÄ¯ didesnis */
        }
        .change-name-btn {
            background-color: #60a5fa;
            color: white;
            padding: 8px 18px;
            border-radius: 6px;
            font-size: 0.95rem;
            transition: background-color 0.2s;
        }
        .change-name-btn:hover {
            background-color: #3b82f6;
        }

        .memo-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 1.05rem;          /* didesnis tekstas lentelÄ—je */
        }
        .memo-table th, .memo-table td {
            border: 1px solid #e5e7eb;
            padding: 12px;
            text-align: left;
        }
        .memo-table th {
            background-color: #f3f4f6;
            font-weight: 700;
            color: #1f2937;
        }
        .memo-table tr:nth-child(even) {
            background-color: #f9fafb;
        }
        .task-description {
            background-color: #e0f2f1;
            padding: 18px 26px;
            border-radius: 8px;
            margin-bottom: 22px;
            border-left: 5px solid #14b8a6;
            font-size: 1.05rem;
        }
        .task-description ol {
            list-style: decimal;
            list-style-position: inside;
            padding-left: 0;
            line-height: 1.7;
        }
        .task-description strong {
            font-weight: 700;
        }

        @media (max-width: 768px) {
            .container-wrapper {
                padding: 16px;
            }
            .card {
                padding: 20px;
            }
            .question-box {
                font-size: 1.3rem;
                padding: 18px;
            }
            .options-row {
                flex-direction: column;
                align-items: stretch;
            }
            .option-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>

<div class="container-wrapper">

    <div class="header-row">
        <a href="/Mokyklai/" class="back-btn">â† GrÄ¯Å¾ti Ä¯ pradÅ¾iÄ…</a>
        <div class="student-info">
            Mokinys: <strong id="studentNameDisplay"></strong>
            <button class="change-name-btn" onclick="changeName()">Keisti vardÄ…</button>
        </div>
    </div>
    
    <h1 class="text-4xl font-extrabold text-center text-gray-800 mb-8">
        MejozÄ— ar MitozÄ—?
    </h1>

    <!-- AtmintinÄ— -->
    <div class="card active" id="memo-card">
        <div class="flex flex-col h-full">
            <h2 class="text-2xl md:text-3xl font-bold text-center text-blue-700 mb-4">
                ğŸ“š AtmintinÄ—: MejozÄ— ir MitozÄ—
            </h2>
            <div class="task-description">
                <h3 class="font-extrabold text-xl text-teal-700 mb-2">UÅ½DUOTIS: SusipaÅ¾ink su informacija</h3>
                <ol>
                    <li><strong>PerÅ¾iÅ«rÄ—k</strong> palyginimo lentelÄ™.</li>
                    <li><strong>Ä®simink</strong> MitozÄ—s ir MejozÄ—s savybiÅ³ skirtumus.</li>
                    <li>Paspausk â€PradÄ—ti testÄ…â€œ.</li>
                </ol>
            </div>
            
            <div class="overflow-x-auto mb-6 flex-grow">
                <table class="memo-table">
                    <thead>
                        <tr>
                            <th>MejozÄ—</th>
                            <th>MitozÄ—</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Susidaro <strong>lytinÄ—s</strong> lÄ…stelÄ—s.</td><td>Susidaro <strong>kÅ«no</strong> lÄ…stelÄ—s.</td></tr>
                        <tr><td>IÅ¡ vienos motininÄ—s lÄ…stelÄ—s susidaro <strong>keturios</strong> dukterinÄ—s lÄ…stelÄ—s.</td><td>IÅ¡ vienos motininÄ—s lÄ…stelÄ—s susidaro <strong>dvi</strong> dukterinÄ—s lÄ…stelÄ—s.</td></tr>
                        <tr><td>Susidariusios lÄ…stelÄ—s yra <strong>skirtingos</strong>.</td><td>Susidariusios lÄ…stelÄ—s yra genetiÅ¡kai <strong>identiÅ¡kos</strong>.</td></tr>
                        <tr><td>SusidariusiÅ³ lÄ…steliÅ³ branduoliai turi <strong>skirtingÄ…</strong> paveldimÄ…jÄ… informacijÄ….</td><td>SusidariusiÅ³ lÄ…steliÅ³ branduoliai turi <strong>vienodÄ…</strong> paveldimÄ…jÄ… informacijÄ….</td></tr>
                        <tr><td>Branduolys dalijasi <strong>du</strong> kartus iÅ¡ eilÄ—s.</td><td>Branduolys dalijasi <strong>vienÄ…</strong> kartÄ….</td></tr>
                        <tr><td>Vyksta <strong>subrendusiame</strong> organizme.</td><td>Vyksta <strong>Ä¯vairaus amÅ¾iaus</strong> organizmuose.</td></tr>
                    </tbody>
                </table>
            </div>
            
            <button id="start-test-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-10 rounded-lg text-xl transition-colors mt-auto self-center">
                PradÄ—ti testÄ…
            </button>
        </div>
    </div>

    <!-- Testas -->
    <div class="card" id="test-card">
        
        <div class="task-description">
            <h3 class="font-extrabold text-xl text-teal-700 mb-2">UÅ½DUOTIS: Priskirk savybÄ™</h3>
            <ol>
                <li><strong>Perskaityk</strong> pateiktÄ… savybÄ™.</li>
                <li><strong>Priskirk</strong> jÄ… Mitozei arba Mejozei.</li>
                <li>Paspausk â€Patikrintiâ€œ.</li>
            </ol>
        </div>
        
        <div class="mb-6">
            <p class="text-xl font-semibold text-gray-500 mb-3 text-center" id="question-count">
                Klausimas 0 iÅ¡ 12
            </p>
            <div class="question-box" id="question-text">
                SavybÄ—s tekstas bus Äia.
            </div>
        </div>

        <div class="options-row" id="options-container">
            <button class="option-btn btn-mejoze" data-type="Mejoze">MejozÄ—</button>
            <button class="option-btn btn-mitoze" data-type="Mitoze">MitozÄ—</button>
        </div>

        <div class="mt-10 text-center">
            <div id="feedback-message" class="text-2xl font-bold min-h-[32px] mb-4"></div>
            <button id="action-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-10 rounded-lg text-xl transition-colors">
                Patikrinti
            </button>
        </div>
    </div>

    <!-- Rezultatai -->
    <div class="card hidden mt-6" id="results-card">
        <h2 class="text-3xl font-bold text-center text-blue-700 mb-4">
            ğŸ‰ Rezultatai
        </h2>
        <p class="text-center text-2xl font-semibold mb-6">
            Teisingai atsakyta: <span id="final-score" class="text-green-600"></span>
        </p>
        <div id="result-details" class="space-y-3 max-h-60 overflow-y-auto p-2 border rounded-md"></div>
        <button onclick="location.reload()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-lg text-lg mt-6 self-center">
            PradÄ—ti iÅ¡ naujo
        </button>
    </div>

</div>

<script>
    const SHEET_URL = 'https://script.google.com/macros/s/AKfycbzhXP3hJ6NBLOld6Gbg-tlN-Tk8BPoxx32tx9j-iKCJChVyeOpZiDyGu9g2cm6Vl0uf/exec';
    const TASK_ID = 'B0001 MejozÄ— vs MitozÄ— | Klasifikacija';

    const DATA = [
        { savybe: "Susidaro lytinÄ—s lÄ…stelÄ—s.", tipas: "Mejoze" },
        { savybe: "Susidaro kÅ«no lÄ…stelÄ—s.", tipas: "Mitoze" },
        { savybe: "IÅ¡ vienos motininÄ—s lÄ…stelÄ—s susidaro keturios dukterinÄ—s lÄ…stelÄ—s.", tipas: "Mejoze" },
        { savybe: "IÅ¡ vienos motininÄ—s lÄ…stelÄ—s susidaro dvi dukterinÄ—s lÄ…stelÄ—s.", tipas: "Mitoze" },
        { savybe: "Susidariusios lÄ…stelÄ—s yra skirtingos.", tipas: "Mejoze" },
        { savybe: "Susidariusios lÄ…stelÄ—s yra genetiÅ¡kai identiÅ¡kos.", tipas: "Mitoze" },
        { savybe: "SusidariusiÅ³ lÄ…steliÅ³ branduoliai turi skirtingÄ… paveldimÄ…jÄ… informacijÄ….", tipas: "Mejoze" },
        { savybe: "SusidariusiÅ³ lÄ…steliÅ³ branduoliai turi vienodÄ… paveldimÄ…jÄ… informacijÄ….", tipas: "Mitoze" },
        { savybe: "Branduolys dalijasi du kartus iÅ¡ eilÄ—s.", tipas: "Mejoze" },
        { savybe: "Branduolys dalijasi vienÄ… kartÄ….", tipas: "Mitoze" },
        { savybe: "Vyksta subrendusiame organizme.", tipas: "Mejoze" },
        { savybe: "Vyksta Ä¯vairaus amÅ¾iaus organizmuose.", tipas: "Mitoze" }
    ];
    const totalQuestions = DATA.length;

    const memoCard = document.getElementById('memo-card');
    const testCard = document.getElementById('test-card');
    const resultsCard = document.getElementById('results-card');
    const startTestBtn = document.getElementById('start-test-btn');
    const questionTextEl = document.getElementById('question-text');
    const questionCountEl = document.getElementById('question-count');
    const actionBtn = document.getElementById('action-btn');
    const feedbackMessageEl = document.getElementById('feedback-message');
    const finalScoreEl = document.getElementById('final-score');
    const resultDetailsEl = document.getElementById('result-details');
    const studentNameDisplay = document.getElementById('studentNameDisplay');

    let currentQuestions = [];
    let currentQuestionIndex = 0;
    let score = 0;
    let isAnswerChecked = false;
    let selectedAnswer = null;
    let userAnswersLog = [];

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function sendResultToSheet(taskName, score) {
        const studentName = localStorage.getItem('studentName') || 'NeÅ¾inomas';
        const timestamp = new Date().toLocaleString('lt-LT');
        
        const data = { name: studentName, task: taskName, score: score, timestamp: timestamp };
        
        fetch(SHEET_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        }).catch(() => {});
    }

    function showNamePrompt() {
        let studentName = localStorage.getItem('studentName');
        if (!studentName) {
            let name = prompt('Ä®veskite savo vardÄ…:');
            if (name && name.trim() !== '') {
                studentName = name.trim();
                localStorage.setItem('studentName', studentName);
            } else {
                alert('PraÅ¡ome Ä¯vesti vardÄ…, kad galÄ—tumÄ—te pradÄ—ti uÅ¾duotÄ¯.');
                return showNamePrompt();
            }
        }
        studentNameDisplay.textContent = studentName;
        return studentName;
    }

    function changeName() {
        localStorage.removeItem('studentName');
        showNamePrompt();
        location.reload();
    }
    window.changeName = changeName;

    function initializeTest() {
        showNamePrompt();

        startTestBtn.addEventListener('click', () => {
            memoCard.classList.remove('active');
            testCard.classList.add('active');
            currentQuestions = shuffleArray([...DATA]);
            currentQuestionIndex = 0;
            score = 0;
            userAnswersLog = [];
            showQuestion();
        });

        // pradinÄ— bÅ«sena
        testCard.classList.remove('active');
        memoCard.classList.add('active');
    }

    function showQuestion() {
        if (currentQuestionIndex >= currentQuestions.length) {
            showResults();
            return;
        }

        const question = currentQuestions[currentQuestionIndex];

        questionCountEl.textContent = `Klausimas ${currentQuestionIndex + 1} iÅ¡ ${totalQuestions}`;
        questionTextEl.textContent = question.savybe;
        feedbackMessageEl.textContent = '';
        actionBtn.textContent = 'Patikrinti';
        actionBtn.onclick = checkAnswer;

        isAnswerChecked = false;
        selectedAnswer = null;

        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.classList.remove('correct', 'incorrect', 'disabled', 'selected-border');
            btn.onclick = handleOptionClick;
        });
    }

    function handleOptionClick(event) {
        if (isAnswerChecked) return;

        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.classList.remove('selected-border');
        });

        event.currentTarget.classList.add('selected-border');
        selectedAnswer = event.currentTarget.dataset.type;
    }

    function checkAnswer() {
        if (!selectedAnswer) {
            feedbackMessageEl.innerHTML = '<span class="text-red-500">âŒ Pasirinkite atsakymÄ…!</span>';
            return;
        }

        isAnswerChecked = true;
        const currentQuestion = currentQuestions[currentQuestionIndex];
        const correctType = currentQuestion.tipas;
        const isCorrect = selectedAnswer === correctType;

        userAnswersLog.push({
            savybe: currentQuestion.savybe,
            pasirinkimas: selectedAnswer,
            teisingas: correctType,
            isCorrect: isCorrect
        });

        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.classList.add('disabled');
            btn.classList.remove('selected-border');

            if (btn.dataset.type === correctType) {
                btn.classList.add('correct');
            } else if (btn.dataset.type === selectedAnswer) {
                btn.classList.add('incorrect');
            }
        });

        if (isCorrect) {
            score++;
            feedbackMessageEl.innerHTML = '<span class="text-green-600">âœ… Teisingai!</span>';
        } else {
            feedbackMessageEl.innerHTML = '<span class="text-red-500">âŒ Neteisingai. Teisingas atsakymas paÅ¾ymÄ—tas Å¾alia spalva.</span>';
        }

        actionBtn.textContent = (currentQuestionIndex < totalQuestions - 1) ? 'Toliau' : 'Rezultatai';
        actionBtn.onclick = nextQuestion;
    }

    function nextQuestion() {
        currentQuestionIndex++;
        selectedAnswer = null;
        showQuestion();
    }

    function showResults() {
        testCard.classList.remove('active');
        resultsCard.classList.add('active');

        const percentage = Math.round((score / totalQuestions) * 100);
        finalScoreEl.textContent = `${score} iÅ¡ ${totalQuestions} (${percentage}%)`;
        finalScoreEl.classList.add(percentage >= 70 ? 'text-green-600' : 'text-red-600');

        let detailsHTML = '';
        userAnswersLog.forEach((answer, index) => {
            const status = answer.isCorrect ? 'Teisingai' : 'Neteisingai';
            const statusClass = answer.isCorrect ? 'text-green-700' : 'text-red-700';

            detailsHTML += `
                <div class="p-3 rounded-md border ${answer.isCorrect ? 'border-green-300 bg-green-50' : 'border-red-300 bg-red-50'}">
                    <p class="font-bold text-gray-800">${index + 1}. ${answer.savybe}</p>
                    <p class="${statusClass} font-semibold mt-1">
                        Atsakymas: ${answer.teisingas} (${status})
                    </p>
                </div>
            `;
        });

        resultDetailsEl.innerHTML = detailsHTML;

        sendResultToSheet(TASK_ID, percentage);
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // paleidimas
    initializeTest();
</script>
</body>
</html>

